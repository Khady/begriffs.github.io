---
title: Creating sqlite tables with Groundhog's default settings
---

{% raw %}
<div class="css-full-post-content js-full-post-content">
I simplified a Groundhog code example to see how it behaves with its default settings. To make this code work you'll need to install some cabal packages.<br /><br /><code data-gist-hide-footer="true" data-gist-hide-line-numbers="true" data-gist-id="6396808"></code> Now for the code. We'll declare tables for Machines and Parts, and create a relationship to say that machines have many parts. Then migrate out in-memory database, insert some sample data and query it.<br /><br /><code data-gist-hide-footer="true" data-gist-hide-line-numbers="true" data-gist-id="6396811"></code> Declaring the data types is standard Haskell. Just some data types that derive <span style="font-family: Courier New, Courier, monospace;">Show</span>. I did notice that I needed to declare <span style="font-family: Courier New, Courier, monospace;">cost</span> as a <span style="font-family: Courier New, Courier, monospace;">Double</span>. I tried <span style="font-family: Courier New, Courier, monospace;">Float</span> initially but it failed.<br /><br />The first magic appears with <span style="font-family: Courier New, Courier, monospace;">mkPersist</span>. &nbsp;Notice it takes a quasiquoted groundhog DSL. I stripped down the declaration here to declare tables with the default settings. If you remove this code then things break. The&nbsp;<span style="font-family: Courier New, Courier, monospace;">mkPersist</span>&nbsp;function writes code for you. Its DSL supports <i>a lot</i> of options, and we'll (dis)cover them in later posts.<br /><br />Given our declarations we can now run migrations. Here's is the SQL it generates:<br /><br /><code data-gist-hide-footer="true" data-gist-hide-line-numbers="true" data-gist-id="6396880"></code><br />Not bad! It adds NULL constraints, declares keys, and links the tables together with references.<br /><br />Next we insert some sample data into the tables. Straightforward. Notice how it then builds a query, but you don't write SQL directly. Writing the queries in Haskell prevents injection and supposedly allows the queries to easily compose. Groundhog introduces its own operators to connect SQL conditions (called <span style="font-family: Courier New, Courier, monospace;">Conds</span>). One such is <span style="font-family: Courier New, Courier, monospace;">==.&nbsp;</span>.<br /><br /><code data-gist-hide-footer="true" data-gist-hide-line-numbers="true" data-gist-id="6396903"></code> Try building and running the code. Seems to work fine.
</div>
{% endraw %}
